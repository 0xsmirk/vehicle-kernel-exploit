# vehicle-kernel-exploit
汽车内核提取漏洞

# 0x00.支持的漏洞

- [x] Nearly all of GTFOBins
- [x] Writeable docker.sock
- [x] CVE-2022-0847 (Dirty pipe)
- [x] CVE-2021-4034 (pwnkit)
- [x] CVE-2021-3560
- [x] CVE-2022-23222

---
# 0x01.Traitor
> https://github.com/liamg/traitor?tab=readme-ov-file#/

打包了一堆方法来利用本地错误配置和漏洞来提升至root shell：
- Nearly all of GTFOBins
- Writeable docker.sock
- CVE-2022-0847 (Dirty pipe)
- CVE-2021-4034 (pwnkit)
- CVE-2021-3560

---
# 0x02.CVE-2022-23222
> https://github.com/tr3ee/CVE-2022-23222#/
> 影响版本:Linux kernel 5.8 - 5.16
> 不受影响版本:Linux kernel 5.10.92, 5.15.15, 5.16.1
> 漏洞利用并不是很稳定

位于eBPF验证器中的漏洞，漏洞允许eBPF程序在未经验证的情况下对特定指针进行运算，通过精心构造的代码，可以实现任意内核内存读写，而这将会造成本地提权的风险。

这个漏洞的利用并不容易，需要本地允许非特权用户执行BPF程序。查看普通用户是否能调用ebpf功能，如果不能，需要将值修改为0。

```shell
tail /proc/sys/kernel/unprivileged_bpf_disabled
echo 0 >/proc/sys/kernel/unprivileged_bpf_disabled
```
值为"0" 表示允许非特权用户调用 bpf。
值为"1" 表示禁止非特权用户调用 bpf 且该值不可再修改,只能重启内核后修改。
值为"2" 表示禁止非特权用户调用 bpf 可以再次修改为 0 或 1 

## 利用效果链接
> https://blog.csdn.net/qq_43472789/article/details/131122660#/